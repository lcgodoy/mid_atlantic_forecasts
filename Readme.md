# Dynamic range models improve the near-term forecast for a marine species on the move

## Alexa L. Fredston,* Daniel Ovando,* Lucas da Cunha Godoy, Jude Kong, Brandon Muffley, James T. Thorson, Malin L. Pinsky

\* *Co-first authors*
  
### Guide to project code

You are welcome to explore and run any code here! For questions please open an Issue here on GitHub. If you reuse or repurpose the code, please cite the manuscript preprint. 

This repository is organized as follows:

- `raw-data` contains any data that were not generated by us, in the form they were made available in (so not necessarily "raw", but not processed in this repository)
- `processed-data` contains data written out by code in this repository
- `functions` contains user-defined functions
- `src` contains source code for Stan models
- `results` contains results written out by the scripts 

Scripts are all in the main project folder. 

To run models for summer flounder, follow these steps:

1. Download the 2020 [OceanAdapt](oceanadapt.rutgers.edu) release from this stable DOI: [10.5281/zenodo.3885625](https://zenodo.org/record/3885625)
1. Run `01_import_summer_flounder.R` to pull in and filter these data
1. Run `02_get_summer_flounder_params.R` to mine parameters from summer flounder stock assessment tables 
1. Run `03_prep_stan_data.R` to reshape the data for the DRM
1. Run `04_run_drms_local.R` to actually run the models locally on your machine. Be warned they are memory- and storage-intensive, and set up to run on a HPC. 
1. Run `05_convergence_checks.R` to summarize diagnostics for the models.
1. Run `06_model_evaluation.R` to iterate over converged models, create alternative models (SDMs, persistence forecast), and quantify model skill.
1. Run `07_thin_posteriors.R` to thin the Stan outputs and make them tractable files. (You can skip this; the outputs of it are on GitHub, so you can still examine the thinned posteriors without running any Stan code or having the full posterior files, which are large.) 
1. Run `08_paper_stats_and_figures.R` to generate the figures and in-text statistics in the manuscript.
1. Run `00_supplement.Rmd` to generate the supplementary materials for the paper.
